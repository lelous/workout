<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Workout Journal Pro</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        :root {
            --bg-primary: #f2f2f7;
            --bg-secondary: #ffffff;
            --text-main: #1c1c1e;
            --text-sub: #8e8e93;
            --primary-grad: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --accent-grad: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            --success-grad: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --border: #d1d1d6;
        }

        [data-theme="dark"] {
            --bg-primary: #000000;
            --bg-secondary: #1c1c1e;
            --text-main: #ffffff;
            --border: #38383a;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-main);
            margin: 0;
            padding-bottom: calc(100px + env(safe-area-inset-bottom));
        }

        .header {
            background: var(--primary-grad);
            color: white;
            padding: calc(45px + env(safe-area-inset-top)) 20px 25px;
            text-align: left;
            border-bottom-left-radius: 24px;
            border-bottom-right-radius: 24px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .container { padding: 20px; max-width: 500px; margin: 0 auto; }

        .card {
            background: var(--bg-secondary);
            border-radius: 24px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.05);
            border: 1px solid var(--border);
        }

        /* IOS INPUT BOXES - 16px to prevent zoom */
        input, textarea {
            font-size: 16px !important;
            padding: 12px;
            border-radius: 12px;
            border: 1.5px solid var(--border);
            background: var(--bg-primary);
            color: var(--text-main);
            width: 100%;
            -webkit-appearance: none;
        }

        .set-row { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; }
        .set-input { width: 80px; text-align: center; font-weight: 700; border-color: transparent; background: var(--bg-primary); }

        .btn {
            width: 100%; padding: 18px; border: none; border-radius: 18px;
            font-size: 17px; font-weight: 700; cursor: pointer;
            transition: transform 0.1s; color: white;
        }
        .btn:active { transform: scale(0.96); }

        .nav {
            position: fixed; bottom: 0; width: 100%;
            background: rgba(var(--bg-secondary), 0.85);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            display: flex; justify-content: space-around;
            padding: 15px 0 calc(10px + env(safe-area-inset-bottom));
            border-top: 0.5px solid var(--border);
        }

        .timer-fab {
            position: fixed; bottom: 120px; right: 20px;
            width: 65px; height: 65px; background: var(--primary-grad);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            color: white; font-weight: 800; box-shadow: 0 10px 25px rgba(118, 75, 162, 0.4);
        }

        .badge {
            padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 800;
            background: var(--accent-grad); color: white; display: inline-block;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ORIGINAL WORKOUT DATA WITH NEW MUSCLE TAGS
        const WORKOUT_CONFIG = {
            monday: { name: "Upper Push", muscles: ["chest", "shoulders", "triceps"], exercises: [
                { name: "Bench Press", sets: 4, reps: "6-8", rest: 180, desc: "Lower to mid-chest, explosive press." },
                { name: "Shoulder Press", sets: 3, reps: "8-10", rest: 120, desc: "Keep core tight, lock out arms." }
            ]},
            tuesday: { name: "Lower Body", muscles: ["quads", "hamstrings", "glutes"], exercises: [
                { name: "Squats", sets: 4, reps: "6-8", rest: 240, desc: "Drive through heels. ACL: Control depth." }
            ]}
        };

        function App() {
            const [view, setView] = useState('home');
            const [selectedDay, setSelectedDay] = useState(null);
            const [workoutLog, setWorkoutLog] = useState(JSON.parse(localStorage.getItem('logs') || '{}'));
            const [weightHistory, setWeightHistory] = useState(JSON.parse(localStorage.getItem('weight') || '[]'));

            useEffect(() => {
                localStorage.setItem('logs', JSON.stringify(workoutLog));
                localStorage.setItem('weight', JSON.stringify(weightHistory));
            }, [workoutLog, weightHistory]);

            return (
                <div>
                    <div className="header">
                        <span className="badge">BUILDING PHASE</span>
                        <h1 style={{fontSize: '32px', margin: '5px 0'}}>My Journal</h1>
                    </div>

                    <div className="container">
                        {view === 'home' && <Home setView={setView} logs={workoutLog} history={weightHistory} setWeight={setWeightHistory}/>}
                        {view === 'workout' && <Workout day={selectedDay} setDay={setSelectedDay} onFinish={(log) => {
                            const date = new Date().toISOString().split('T')[0];
                            setWorkoutLog({...workoutLog, [date]: log});
                            setView('home');
                        }}/>}
                    </div>

                    <div className="nav">
                        <div onClick={() => setView('home')}>üè†</div>
                        <div onClick={() => setView('workout')}>üí™</div>
                        <div>üìä</div>
                    </div>
                </div>
            );
        }

        function Home({ setView, logs, history, setWeight }) {
            const lastWeight = history[history.length - 1]?.val || 0;
            
            return (
                <>
                    <div className="card" style={{background: 'var(--primary-grad)', color: 'white'}}>
                        <h4 style={{opacity: 0.8}}>Weekly Tonnage</h4>
                        <h2 style={{fontSize: '36px'}}>42,500 <span style={{fontSize: '16px'}}>lbs</span></h2>
                    </div>

                    <button className="btn" style={{background: 'var(--success-grad)', marginBottom: '20px'}} onClick={() => setView('workout')}>
                        START SESSION
                    </button>

                    <div className="card">
                        <h3>Weight Tracker</h3>
                        <div className="set-row">
                            <input type="number" inputMode="decimal" placeholder="Log Current Weight" onBlur={(e) => {
                                if(e.target.value) setWeight([...history, {val: e.target.value, date: new Date().toLocaleDateString()}]);
                            }}/>
                        </div>
                        <p style={{fontSize: '12px', color: 'var(--text-sub)'}}>Last logged: {lastWeight} lbs</p>
                    </div>
                </>
            );
        }

        function Workout({ day, setDay, onFinish }) {
            const [sessionSets, setSessionSets] = useState({});
            const [rest, setRest] = useState(0);

            const startRest = (seconds) => {
                setRest(seconds);
                const timer = setInterval(() => {
                    setRest((prev) => {
                        if (prev <= 1) {
                            clearInterval(timer);
                            if (navigator.vibrate) navigator.vibrate([200, 100, 200]);
                            return 0;
                        }
                        return prev - 1;
                    });
                }, 1000);
            };

            if (!day) return (
                <div>
                    {Object.keys(WORKOUT_CONFIG).map(d => (
                        <div key={d} className="card" onClick={() => setDay(d)}>
                            <h2 style={{color: 'var(--primary)'}}>{d.toUpperCase()}</h2>
                            <p>{WORKOUT_CONFIG[d].name}</p>
                        </div>
                    ))}
                </div>
            );

            const currentWorkout = WORKOUT_CONFIG[day];

            return (
                <div>
                    {currentWorkout.exercises.map((ex, i) => (
                        <div key={i} className="card">
                            <h3>{ex.name}</h3>
                            <p style={{fontSize: '12px', color: 'var(--text-sub)', marginBottom: '15px'}}>{ex.desc}</p>
                            {[...Array(ex.sets)].map((_, s) => (
                                <div key={s} className="set-row">
                                    <span style={{width: '60px', fontWeight: 'bold'}}>Set {s+1}</span>
                                    <input type="number" inputMode="decimal" className="set-input" placeholder="185" onBlur={() => startRest(ex.rest)} />
                                    <input type="number" inputMode="decimal" className="set-input" placeholder="8" />
                                </div>
                            ))}
                        </div>
                    ))}
                    <button className="btn" style={{background: 'var(--primary-grad)'}} onClick={() => onFinish({day})}>
                        FINISH WORKOUT
                    </button>
                    {rest > 0 && <div className="timer-fab" onClick={() => setRest(0)}>{rest}s</div>}
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
